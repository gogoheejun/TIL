# 1:M, M:N관계 연습문제1

프로그램 설계에 앞서 데이터베이스 설계가 선행되는데, 이때 데이터베이스 테이블 명 정하는게 매우 중요. 이걸 그대로 프로그램에서 따라 써야 하기때문에.

# 중학교 학생 성적관리 프로젝트

- 과목은 학년별로 담당선생님이 따로 있다.
- 시험은 중간고사, 기말고사 두가지가 있다.
- 학생들은 학년, 반에 배정되며 반별로 학생들에게 고유 번호를 부여하고 있다
- 각 반에는 선생님이 배정되어 있다. 선생님 중에는 담임을 맡지 않는 선생님도 있다.
- 한 반의 학생은 대략 40명정도이고 남녀공학이다.
- 석차는 남녀 공통 1등부터 순서대로 정한다.

---

풀이시작!

1. 

   → 명사 동사 빼거 다 제거!

   - 과목, ~~학년, (아래에 학년나와서 없앰),~~ 담당선생님
   - 시험,중간고사, 기말고사
   - 학생, 학년, 반에 배정, 고유 번호(반별
   - 담임선생님,선생님
   - —한 반의 학생은 대략 40명정도—
   - 남녀공학
   - 석차(남녀 공통 1등부터 성적순서대로)

2. 

   이제 테이블 만들자. 그러려먼 아래처럼 정리해야하고, 더 자세한건 고객의 요구사항을 물어봐야함.

   - 마스터테이블:

   과목, 담임, 선생님, 

   학생(40명정도/반),학년,반,고유번호,

   (성적),석차(반별석차,학년별석차)

   시험(중간고사, 기말고사)

   - 관계테이블:

   시험(보다) , 배정하다

   학생(40명정도/반)

3. 

   분해할 수 없을 정도로 마스터를 만들어야 해. 그러나 또 굳이 필요없는 것도 다 만들 필요는 없어.

   마스터테이블 중 부모자식관계가 있는지 찾아서다시 정리

   학생(40명정도/반, 반별 고유번호 존재),학년,반

   과목, 선생님(담임,비담임)

   성적,(반,학년 석차)

   시험(중간고사, 기말고사)

4. 

   일단 학생이 시험을 보는 거니 학생,학년,반 테이블을 먼저 만들어보자.

   학년테이블은 학년id를 가지고 있고 얘는 PK임. 그리고 절대 자식이나 FK가 될 수 없어. 자식이 되려면 어느 학교의 몇학년 이래야 하는데, 지금은 하나의 학교만 하니까..

   이런 테이블을 **기준테이블** 이라고 함.

   기준테이블은 특별히 신경써서 하고, 보통 직접 디비설계할때 내용 입력하고, 프로그래머들이 select외에는 crud못하게 함. 여기선 어차피 학년 1,2,3만 있고 나중에 안바뀜.

5. 테이블 기초 설계. 

- 학생(40명정도/반, 반별 고유번호 존재),학년,반

student명 앞에 TB_를 붙여줘서 프로그래머들이 알아듣기 편하게 함.Class도 자바에 있는 클래스랑 같으니까 피해서 SchoolClass라 해줌
![Untitled](https://user-images.githubusercontent.com/78577071/127800822-7eff8151-55e8-4331-af15-a466ee825917.png)

- 과목, 선생님(담임,비담임)
![Untitled 1](https://user-images.githubusercontent.com/78577071/127800831-e6601160-bf40-4454-80b2-8f1cb529de0c.png)

- 위 두개의 집단 잇기.

보통  거의 대부분의 테이블이 다 연결되어 있음. 따로 떨어진 애는 로그테이블같은 것 뿐.

-OpenLecture테이블에 SchoolGrade의 Schoolgradeid(pk)를 외래키로 가져오고, 얘를 포함해서 PK를 이루게 함. 

→"몇년도에 몇학년 어느과목에 어느선생님이 강의를 오픈했다" 자체가 PK가 됨.
![Untitled 2](https://user-images.githubusercontent.com/78577071/127800835-af0fe36c-6e03-417a-874f-c27b24ebeea0.png)


-TB_Teacher의 teacherId를 TB_SchoolClass의 외래키로 넣음. 두 테이블은 1:1관계이지만 1:M의 형식을 갖추게 됨. 그러나 여기선 1:1이다 이런게 중요한 게아니고, TB_SchoolClass의 TeacherId 정보가 TB_Teacher에서만 나와야 한다고 못밖는 역할을 하게 되는것임. 즉 TB_Teacher가 기준테이블의 역할을 한다.

글구 그 반의 담임을 쌤이 언제 했는지 넣음. 김쌤이 1반담임을 3년전에 한건 올해 한거랑 다르니까.

![Untitled 3](https://user-images.githubusercontent.com/78577071/127800847-988b41ed-3a79-489e-bbda-a4be0b85f485.png)

이너조인하면 담임, 아우터조인하면 비담임 나옴.

- 성적,(반,학년 석차), 시험(중간고사, 기말고사)

성적이 과목별로 있잖아? 국어수학영어 등등.. 성적이란 한 칼럼안에 국어수학영어를 한방에 넣으면 안된다.!

[이름 성적(국,수영)]  이렇게 칼럼 수 줄여서 다음처럼 코딩하면서 풀면 문제가 발생

![Untitled 4](https://user-images.githubusercontent.com/78577071/127800850-4184ebc4-e02f-4f2a-bcce-9924e2abd6bd.png)

무슨 문제? 나중에 조인을 절대 할수가 없어짐. 또한, PK가 결정되면 다른 칼럼하나는 뭐!하고 딱딱 나와야함. 학생1번이면 핸드폰번호 뭐! 이렇게 딱 나와야 하는데 그렇지가 않기에  join도 불가능.

일단 TB_Score테이블 하나 만들고 외래키로 OpenLecture테이블의 보조키였던 Seq을 가져옴. 보조키는 외래키 역할 가능하다!(안그러면 teacherid,subjectid,opendate,schoolgradeid 다 가져와야 하는데 넘 힘들잖아.) 글고 Studnetid와 함께 두개를 PK로 설정.
Studnetid는 TB_Stduent의 PK로부터 가져온 외래키이면서 PK가 되는 것임.

![Untitled 5](https://user-images.githubusercontent.com/78577071/127800859-2cda1ffa-21c4-462d-94d3-16424fbf3150.png)

- 다 정리해보면 다음처럼 됨 openLecture라는 관계테이블이 가운데에 감 보통.
![Untitled 6](https://user-images.githubusercontent.com/78577071/127800866-7f725e44-c017-43b4-b134-f74a1d1aa23e.png)


